<!doctype html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<title>점심 메뉴 룰렛</title>

<!-- GSAP CDN -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.5/gsap.min.js"></script>

<style>
  :root {
    --size: 480px;          /* 룰렛 지름 한 번에 바꾸려면 여기만 수정 */
  }

  body{
    display:flex;
    flex-direction:column;
    align-items:center;
    justify-content:center;
    gap:32px;
    min-height:100vh;
    font-family:system-ui, sans-serif;
    background:#f7f7f7;
  }
  #wheelBox{
    width:var(--size);
    height:var(--size);
    position:relative;
  }
  /* 화살표(포인터) */
  #pointer{
    position:absolute;
    top:-18px;
    left:50%;
    width:0;
    height:0;
    border-left:16px solid transparent;
    border-right:16px solid transparent;
    border-bottom:24px solid #ff5252;
    transform:translateX(-50%);
    z-index:10;
  }
  button{
    padding:12px 24px;
    font-size:1.1rem;
    border:none;
    border-radius:6px;
    background:#2196f3;
    color:#fff;
    cursor:pointer;
  }
  button:disabled{
    opacity:.6;
    cursor:not-allowed;
  }
</style>
</head>
<body>

<h1>오늘 점심 뭐 먹지? 🍽️</h1>

<div id="wheelBox">
  <div id="pointer"></div>

  <!-- SVG 룰렛 (JS에서 동적으로 생성) -->
  <svg id="wheel" viewBox="-1 -1 2 2" style="width:100%;height:100%;transform:rotate(0deg);">
    <!-- slice <path>들이 여기에 주입 -->
  </svg>
</div>

<button id="spinBtn">룰렛 돌리기!</button>

<script>
/* 1) 메뉴 목록만 바꾸면 자동으로 룰렛이 다시 그려집니다 */
const menus = ["김치찌개", "돈까스", "제육볶음", "짜장면", "쌀국수", "샐러드", "초밥", "햄버거"];

const wheel     = document.getElementById("wheel");
const spinBtn   = document.getElementById("spinBtn");
const sliceDeg  = 360 / menus.length;

/* 2) SVG 파이 슬라이스와 중앙 텍스트 만들기 */
menus.forEach((label, i) => {
  const startAngle = i * sliceDeg;
  const endAngle   = startAngle + sliceDeg;
  const largeArc   = sliceDeg > 180 ? 1 : 0;

  /* 호(arc)-끝점 좌표 계산 (단위: 반지름=1) */
  const start = polarToCartesian(startAngle);
  const end   = polarToCartesian(endAngle);

  /* 파이-조각 path */
  const path = document.createElementNS("http://www.w3.org/2000/svg","path");
  path.setAttribute("d", [
    `M 0 0`,
    `L ${start.x} ${start.y}`,
    `A 1 1 0 ${largeArc} 1 ${end.x} ${end.y}`,
    `Z`
  ].join(" "));
  path.setAttribute("fill", `hsl(${startAngle+sliceDeg/2}, 70%, 60%)`);
  wheel.appendChild(path);

  /* 가운데 텍스트(살짝 안쪽에 배치) */
  const midAngle = startAngle + sliceDeg / 2;
  const mid      = polarToCartesian(midAngle, 0.55);   // 반지름 *0.55 위치
  const text = document.createElementNS("http://www.w3.org/2000/svg","text");
  text.textContent = label;
  text.setAttribute("x", mid.x);
  text.setAttribute("y", mid.y);
  text.setAttribute("text-anchor","middle");
  text.setAttribute("alignment-baseline","middle");
  text.setAttribute("fill","#000");
  text.setAttribute("font-size","0.18px");             // SVG viewBox 기준
  text.setAttribute("transform", `rotate(${midAngle} ${mid.x} ${mid.y})`);
  wheel.appendChild(text);
});

/* 3) 회전 함수 */
spinBtn.addEventListener("click", () => {
  spinBtn.disabled = true;

  const chosenIdx  = Math.floor(Math.random() * menus.length);
  const offsetDeg  = sliceDeg / 2; // 룰렛 위쪽 포인터가 slice 중앙을 가리키도록 보정
  const targetRot  = 360 * 6 + (360 - chosenIdx * sliceDeg - offsetDeg);

  gsap.to(wheel, {
    rotation: targetRot,
    duration: 5,
    ease: "power4.out",
    onComplete: () => {
      alert(`오늘 점심은 ➡️ [ ${menus[chosenIdx]} ]! 😋`);
      spinBtn.disabled = false;
    }
  });
});

/* 4) 각도→좌표 변환 헬퍼 */
function polarToCartesian(angleDeg, radius = 1){
  const rad = (angleDeg - 90) * Math.PI / 180; // SVG는 12시 방향부터 시계방향
  return { x: radius * Math.cos(rad), y: radius * Math.sin(rad) };
}
</script>
</body>
</html>
